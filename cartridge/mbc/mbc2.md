# MBC2

対応カートリッジ: 最大256KiBのROM and 512x4 bitsのRAM

## メモリ

### 0000-3FFF - ROMバンク 00 (R)

ROMの最初の16KiB

### 4000-7FFF - ROMバンク 01-0F (R)

MBC1と同じですが、バンクは最大16個までです。

### A000-A1FF - 512x4ビットの RAM (R/W)

MBC2は外付けのRAMには対応しておらず、512×4bitの内蔵RAM（MBC2チップ自体）を搭載しています。

ただし、電源オフ時のデータ保存には外部バッテリーが必要です。

データは4bitの値で構成されています。つまり1アドレスに保存できるデータのサイズは1バイトではなく4bitなため、このメモリ領域のビットオクテットのうち下位4bitのみが使用されます。各バイトの上位4bitの仕様は未定義なので、当てにしてはいけません。

### A200-BFFF - A000-A1FFのミラー

A000-A1FFのミラーが15回並んでいます。

A000-A1FF領域と同様に、バイトの下位4bitのみが使用され、各バイトの上位4bitは未定義であり、当てにしてはいけません。

## レジスタ

### 0000-3FFF - RAM有効フラグ & ROMバンク番号 (W)

このアドレス領域は、RAMの有効化/無効化と、ROMバンクの制御の両方を担当します。

アドレスのbit8（上位アドレスバイトの最下位ビット）は、RAM有効フラグを制御するか、ROMバンクを制御するかを決定します。

**bit8 が0**

上位アドレスバイトの最下位ビット(bit8)が0の場合、書き込まれた値によって、RAMを有効にするかどうかが制御されます。

このアドレス範囲に書き込まれた値が`0Ah`と等しい場合、RAMが有効になります。それ以外の値が書き込まれた場合は、RAMが無効になります。

RAMを制御できるアドレスの例： `$0000..00FF`, `$0200..02FF`, `$0400..04FF`, ..., `$3E00..3EFF`

デフォルトでは、RAMは無効になっています。

**bit8 が1**

上位アドレスバイトの最下位ビット(bit8)が1の場合、書き込まれた値は、`$4000..7FFF`のROMバンクを制御します。

具体的には、このアドレス範囲に書き込まれた値の下位4bitが、ROMのバンク番号を指定します。バンク0を書き込んだ場合、結果としてバンク1になります。

ROMを制御できるアドレスの例: `$0100..01FF`, `$0300..03FF`, `$0500..05FF`, ..., `$3F00..3FFF`.

デフォルトではバンク番号は1です。
